
// Handle the Messier routines, and
// try to keep the data away until
// the linking process

#include "stdafx.h"

extern void MakeLocal(double RA,double Dec, double *Az, double *Alt);

struct mess_type {
	 char name[20];
	float ra,dec;
} ;

struct mess_cords_type {
	float alt,azm;
} ;

struct mess_cords_type mcords[110];

struct mess_type mess[110]=
{
{"1 Crab Nebula",5.56805556,22.0166667},
{"2",21.5513889,-0.816666667},
{"3",13.7005556,28.3833333},
{"4",16.385,-26.5333333},
{"5",15.3016667,2.08333333},
{"6",17.6669445,-32.2166667},
{"7",17.8858333,-34.8166667},
{"8 Lagoon Nebula",18.0522222,-24.3833333},
{"9",17.3172222,-18.5166667},
{"10",16.9502778,-4.1},
{"11",18.8502778,-6.26666667},
{"12",16.7838889,-1.95},
{"13",16.6852778,36.4666667},
{"14",17.6183333,-3.25},
{"15",21.5,12.1666667},
{"16 Eagle Nebula",18.3022222,-13.7833333},
{"17 Omega Nebula",18.3355556,-16.1833333},
{"18",18.3191667,-17.1333333},
{"19",17.035,-26.2666667},
{"20 Trifid Nebula",18.035,-23.0333333},
{"21",18.0683333,-22.5},
{"22",18.6011111,-23.9},
{"23",17.9355556,-19.0166667},
{"24",18.2691667,-18.4833333},
{"25",18.5183333,-19.25},
{"26",18.7505556,-9.4},
{"27 Dumbbell Nebula",19.985,22.7166667},
{"28",18.4013889,-24.8666667},
{"29",20.3858333,38.5333333},
{"30",21.6677778,-23.1833333},
{"31 Andromeda Galaxy",0.701944445,41.2666667},
{"32",0.701944445,40.8666667},
{"33",1.5525,30.65},
{"34",2.7,42.7833333},
{"35",6.13583333,24.3333333},
{"36",5.60027778,34.1333333},
{"37",5.86777778,32.55},
{"38",5.46861111,35.8333333},
{"39",21.5338889,48.4333333},
{"40",12.3677778,58.0833333},
{"41",6.78333333,-20.7333333},
{"42 Orion Nebula",5.58444445,-5.45},
{"43",5.585,-5.26666667},
{"44 Beehive Cluster",8.66694445,19.9833333},
{"45 Pleiades",3.78333333,24.1166667},
{"46",7.68555556,-14.8166667},
{"47",7.60166667,-14.5},
{"48",8.21888889,-5.8},
{"49",12.4855556,8},
{"50",7.05055556,-8.33333333},
{"51 Whirlpool Galaxy",13.4858333,47.2},
{"52",23.4005556,61.5833333},
{"53",13.2025,18.1666667},
{"54",18.9169445,-30.4833333},
{"55",19.6666667,-30.9666667},
{"56",19.2683333,30.1833333},
{"57 Ring Nebula",18.885,33.0333333},
{"58",12.6186111,11.8166667},
{"59",12.7,11.65},
{"60",12.7186111,11.55},
{"61",12.3525,4.46666667},
{"62",17.0172222,-30.1166667},
{"63",13.2522222,42.0333333},
{"64 Blackeye Galaxy",12.9352778,21.6833333},
{"65",11.3025,13.0833333},
{"66",11.3338889,12.9833333},
{"67",8.83444445,11.8166667},
{"68",12.6513889,-26.75},
{"69",18.5677778,-32.35},
{"70",18.7172222,-32.3},
{"71",19.8855556,18.7833333},
{"72",20.8847222,-12.5333333},
{"73",20.9691667,-12.6333333},
{"74",1.60194445,15.7833333},
{"75",20.1002778,-21.9166667},
{"76",1.70111111,51.5666667},
{"77",2.70194445,-0.0166666667},
{"78",5.76861111,0.05},
{"79",5.40138889,-24.55},
{"80",16.2833333,-22.9833333},
{"81",9.91833333,69.0666667},
{"82",9.91888889,69.6833333},
{"83",13.6166667,-29.8666667},
{"84",12.4169445,12.8833333},
{"85",12.4177778,18.1833333},
{"86",12.4338889,12.95},
{"87",12.5022222,12.4},
{"88",12.5333333,14.4166667},
{"89",12.5852778,12.55},
{"90",12.6022222,13.1666667},
{"91",12.5844445,14.5},
{"92",17.2836111,43.1333333},
{"93",7.735,-23.8666667},
{"94",12.8358333,41.1166667},
{"95",10.7333333,11.7},
{"96",10.7688889,11.8166667},
{"97 Owl Nebula",11.2355556,55.0166667},
{"98",12.2188889,14.9},
{"99",12.3022222,14.4166667},
{"100",12.3691667,15.8166667},
{"101",14.0508333,54.35},
{"102",15.1013889,55.75},
{"103",1.55055556,60.7},
{"104",12.6666667,-11.6166667},
{"105",10.7855556,12.5833333},
{"106",12.3166667,47.3},
{"107",16.5347222,-13.05},
{"108",11.1847222,55.6666667},
{"109",11.9516667,53.3833333},
{"110",0.667777778,41.6833333}
};


void CalculateMess()
{
	// Using the current time,location etc calculate
	// the Alt.Az for all the Messier objects

	double az,alt;
	short int i;

	for (i=0;i<110;i++)
	{
		MakeLocal((double)mess[i].ra,(double)mess[i].dec,&az,&alt);
		mcords[i].alt=float(alt); // radians
		mcords[i].azm=float(az);   // radians
	}
}


double Get_Mess_Alt(int i)
{
	return mcords[i].alt;
}

double Get_Mess_Azm(int i)
{
	return mcords[i].azm;
}

/*
char * Get_Mess_Name(int i)
{
	return &mess[i].name[0];
}
*/

//CString plop;

CString Get_Mess_String(int i)
{

	return mess[i].name;

	//	return plop;
}
